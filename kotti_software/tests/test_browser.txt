kotti_software browser tests
========================

Setup and Login
---------------

  >>> import datetime
  >>> from dateutil.tz import tzutc
  >>> from kotti import tests
  >>> from kotti.views.util import format_date
  >>> first_time_string = "2012-07-31 05:00:00"
  >>> first_date = datetime.datetime(2012, 7, 31, 5, 0, 0, tzinfo=tzutc())
  >>> second_time_string = "2012-07-31 06:00:00"
  >>> second_date = datetime.datetime(2012, 7, 31, 6, 0, 0, tzinfo=tzutc())
  >>> tools = tests.setUpFunctional(
  ...     **{'kotti.configurators': 'kotti_software.kotti_configure'})
  >>> browser = tools['Browser']()
  >>> ctrl = browser.getControl

  >>> browser.open(tests.BASE_URL + '/@@login')
  >>> "Log in" in browser.contents
  True
  >>> ctrl("Username or email").value = "admin"
  >>> ctrl("Password").value = "secret"
  >>> ctrl(name="submit").click()
  >>> "Welcome, Administrator" in browser.contents
  True

Add a software collection 
-------------------------

  >>> browser.open(tests.BASE_URL + '/@@add_softwarecollection')
  >>> ctrl("Title").value = "New Software Collection"
  >>> ctrl("Body").value = "This is the new software collection"
  >>> ctrl("save").click()
  >>> "Successfully added item" in browser.contents
  True
  >>> browser.url == tests.BASE_URL + '/new-software-collection/'
  True

Add softwareprojects
--------------------

  >>> browser.open(tests.BASE_URL + '/new-software-collection/@@add_softwareproject')
  >>> ctrl("Title").value = "First software project"
  >>> ctrl("Body").value = "This project concerns throwing dice..."
  >>> ctrl("Date", index=0).value = first_time_string
  >>> ctrl("save").click()
  >>> "Successfully added item" in browser.contents
  True

  >>> browser.open(tests.BASE_URL + '/new-software-collection/@@add_softwareproject')
  >>> ctrl("Title").value = "Second software project"
  >>> ctrl("Body").value = "This project is about hurricanes"
  >>> ctrl("Date", index=0).value = second_time_string
  >>> ctrl("save").click()
  >>> "Successfully added item" in browser.contents
  True


View software collection and software project
---------------------------------------------

  >>> browser.open(tests.BASE_URL + '/new-software-collection/')
  >>> "First software project" in browser.contents
  True
  >>> format_date(second_date) in browser.contents
  True
  >>> pos = browser.contents.index
  >>> pos("Second software project") < pos("First software project")
  True
  >>> browser.getLink("Second software project").click()
  >>> "This project is about hurricanes" in browser.contents
  True


Edit software collection and software project and verify the changes
--------------------------------------------------------------------

  >>> browser.open(tests.BASE_URL + '/new-software-collection/@@edit')
  >>> ctrl("Title").value = "This is the Software Collection"
  >>> ctrl("Body").value = "Hello, I am a software collection"
  >>> ctrl("save").click()

  >>> browser.open(tests.BASE_URL + '/new-software-collection/first-software-project/@@edit')
  >>> ctrl("Title").value = "I was the first software project"
  >>> ctrl("save").click()

  >>> browser.open(tests.BASE_URL + '/new-software-collection/')
  >>> "Hello, I am a software collection" in browser.contents
  True
  >>> "First software project" in browser.contents
  False
  >>> "I was the first software project" in browser.contents
  True
  >>> "This project concerns throwing dice..." in browser.contents
  True
